from dataclasses import dataclass
from typing import List

from yaml import FullLoader, load_all


@dataclass
class DeploymentFile(object):
    content: str
    path: str


def get_deployment_files(project, files_path) -> List[DeploymentFile]:
    files = []
    for path in files_path:
        project_file = project.files.get(file_path=path["filename"], ref="develop")
        loaded_yaml_content = next(load_all(project_file.decode(), Loader=FullLoader))
        files.append(DeploymentFile(content=loaded_yaml_content, path=path["filename"]))
    return files
